
## åœ˜éšŠåˆ†å·¥è¡¨

### ä¸€ã€å°ˆæ¡ˆæ¶æ§‹

```
ai-attention-project/
â”œâ”€â”€ detector/            ğŸ‘¤ A - åµæ¸¬æ¨¡çµ„
â”‚   â””â”€â”€ eye_tracker.py   # è‡‰éƒ¨èˆ‡çœ¼éƒ¨ landmark åµæ¸¬åŠ EAR è¨ˆç®—
â”‚
â”œâ”€â”€ logic/               ğŸ‘¤ C - åˆ¤æ–·æ¨¡çµ„
â”‚   â””â”€â”€ sleep_detector.py # æ™‚é–“ç´¯è¨ˆèˆ‡ç‹€æ…‹åˆ†æé‚è¼¯
â”‚
â”œâ”€â”€ web_ui/              ğŸ‘¤ B - é¡¯ç¤ºæ¨¡çµ„
â”‚   â””â”€â”€ display.py       # ç•«æ¡†ã€é¡¯ç¤ºå³æ™‚ç•«é¢èˆ‡æç¤º
â”‚
â”œâ”€â”€ shared/              ğŸ‘¥ å…±ç”¨æ¨¡çµ„
â”‚   â”œâ”€â”€ config.py        # é–¾å€¼èˆ‡åƒæ•¸è¨­å®š
â”‚   â””â”€â”€ utils.py         # ç•«æ¡†ã€æ™‚é–“æ ¼å¼åŒ–ç­‰å·¥å…·å‡½æ•¸
â”‚
â”œâ”€â”€ main.py              ğŸ§© æ•´åˆå…¥å£ï¼Œä¸²æ¥æ‰€æœ‰æ¨¡çµ„
â”œâ”€â”€ requirements.txt     ğŸ“¦ å¥—ä»¶åˆ—è¡¨
â”œâ”€â”€ .gitignore           ğŸ”’ å¿½ç•¥æ¸¬è©¦å½±ç‰‡ã€æš«å­˜æª”ç­‰
â””â”€â”€ README.md            ğŸ“– å°ˆæ¡ˆèªªæ˜èˆ‡åˆ†å·¥ç´€éŒ„
```

### äºŒã€åŠŸèƒ½èˆ‡æ¥å£è¦ç¯„

| æˆå“¡    | æ¨¡çµ„æª”æ¡ˆ                      | ä¸»è¦å‡½æ•¸                           | è¼¸å…¥                | è¼¸å‡º                                                  | å‚™è¨»          |
| ----- | ------------------------- | ------------------------------ | ----------------- | --------------------------------------------------- | ----------- |
| **A** | `detector/eye_tracker.py` | `detect_eye_and_face(frame)`   | `frame` (å½±æ ¼)      | `{ 'eye_found': bool, 'face_found': bool }`         | åŸºç¤åµæ¸¬ï¼Œæä¾›åŸå§‹ç‹€æ…‹ |
| **C** | `logic/sleep_detector.py` | `analyze_state(detect_res)`    | åµæ¸¬çµæœ dict         | `status` å­—ä¸² (`'attentive'/'zoning out'/'sleeping'`) | æ™‚é–“é–¾å€¼ã€ç•°å¸¸æ¢ä»¶å¯¦ä½œ |
| **B** | `web_ui/display.py`       | `render_result(frame, status)` | `frame`, `status` | é¡¯ç¤ºè¦–çª—ï¼Œä¸¦åœ¨ç•«é¢æ¡†é¸ç•°å¸¸è€…                                      | UI ä»‹é¢èˆ‡äº’å‹•    |

### ä¸‰ã€ä¸»è¦åƒæ•¸è¨­å®šï¼ˆshared/config.pyï¼‰

```python
# å–®ä½ï¼šç§’
THRESHOLD_EYE_MISSING = 3       # çœ¼ç› landmark æ¶ˆå¤±ç§’æ•¸
THRESHOLD_FACE_MISSING = 5      # è‡‰éƒ¨ landmark æ¶ˆå¤±ç§’æ•¸
VIDEO_SOURCE = 0                # æ”å½±æ©Ÿç·¨è™Ÿæˆ–å½±ç‰‡è·¯å¾‘
```

### å››ã€å…±ç”¨å·¥å…·å‡½æ•¸ï¼ˆshared/utils.pyï¼‰

```python
import cv2

def draw_box(frame, box, color=(0,255,0), thickness=2):
    x, y, w, h = box
    return cv2.rectangle(frame, (x, y), (x+w, y+h), color, thickness)

# å¯ä¾éœ€æ“´å……å…¶ä»–æ ¼å¼åŒ–æˆ–è¨ˆç®—å·¥å…·
```

### äº”ã€æ•´åˆå…¥å£ç¯„ä¾‹ï¼ˆmain.pyï¼‰

```python
import cv2
from shared.config import VIDEO_SOURCE
from shared.utils import draw_box
from detector.eye_tracker import detect_eye_and_face
from logic.sleep_detector import analyze_state
from web_ui.display import render_result

cap = cv2.VideoCapture(VIDEO_SOURCE)

while cap.isOpened():
    ret, frame = cap.read()
    if not ret:
        break

    # A: åµæ¸¬
    detect_res = detect_eye_and_face(frame)
    # C: åˆ¤æ–·
    status = analyze_state(detect_res)
    # B: é¡¯ç¤º
    render_result(frame, status)

    if cv2.waitKey(1) & 0xFF == ord('q'):
        break

cap.release()
cv2.destroyAllWindows()
```

### å…­ã€å”ä½œæµç¨‹èˆ‡æ³¨æ„äº‹é …

1. **å„è‡ªé–‹ç™¼ï¼š**

   * A/B/C åƒ…ä¿®æ”¹è‡ªå·±è³‡æ–™å¤¾å…§çš„ç¨‹å¼ç¢¼ï¼Œ`shared/` åƒ…åšè®€å–ã€‚
2. **ç‰ˆæœ¬åŒæ­¥ï¼š**

   * é–‹å·¥å‰åŸ·è¡Œ `git pull`ï¼›å®Œæˆå¾ŒåŸ·è¡Œ `git add/commit/push`ã€‚
3. **è¡çªé¿å…ï¼š**

   * ä¸è¦ä¸‰äººåŒæ™‚ä¿®æ”¹åŒä¸€æª”æ¡ˆï¼›å¦‚æœ‰å¿…è¦æ–°å¢å‡½å¼ï¼Œè«‹åœ¨ shared/utils.py æˆ–è‡ªå·±æ¨¡çµ„ä¸­æ–°å¢å‘½åç©ºé–“ã€‚
4. **å®šæœŸæ•´åˆï¼š**

   * ç¬¬äºŒé€±é–‹å§‹æ¯æ—¥æ•´åˆæ¸¬è©¦ï¼Œç¬¬ä¸‰é€±å®Œæˆ main.py ä¸²æ¥ã€‚

---

å¦‚æ­¤ä¸€ä¾†ï¼Œä¸‰ä½æˆå“¡æ—¢å„æœ‰åˆ†å·¥ï¼Œåˆå¯ä»¥é€éä¸»ç¨‹å¼ç„¡è¡çªåœ°æ•´åˆï¼Œç¢ºä¿å°ˆæ¡ˆé€²åº¦èˆ‡å“è³ªã€‚
